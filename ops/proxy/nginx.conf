server {
  listen 443 ssl http2;
  server_name _;

  add_header Strict-Transport-Security "max-age=15552000; includeSubDomains" always;
  add_header Referrer-Policy "strict-origin-when-cross-origin" always;
  add_header X-Content-Type-Options "nosniff" always;
  add_header X-Frame-Options "DENY" always;
  add_header Permissions-Policy "accelerometer=(), autoplay=(), camera=(), clipboard-read=(), clipboard-write=(), display-capture=(), document-domain=(), encrypted-media=(), fullscreen=*, geolocation=(), gyroscope=(), hid=(), idle-detection=(), magnetometer=(), microphone=(), midi=(), payment=(), picture-in-picture=*, publickey-credentials-get=(), screen-wake-lock=(), serial=(), speaker-selection=(), usb=(), web-share=(), xr-spatial-tracking=()" always;

  location /_next/static/ {
    proxy_pass http://127.0.0.1:3010;
    add_header Cache-Control "public, max-age=31536000, immutable" always;
  }
  location ~* \.(svg|jpg|jpeg|png|gif|webp|avif|ico|css|js|woff|woff2|ttf)$ {
    proxy_pass http://127.0.0.1:3010;
    add_header Cache-Control "public, max-age=31536000, immutable" always;
  }
  location /api/ {
    proxy_pass http://127.0.0.1:3010;
    add_header Cache-Control "no-store" always;
  }
  location / {
    proxy_pass http://127.0.0.1:3010;
    add_header Cache-Control "s-maxage=60, stale-while-revalidate=300" always;
  }
}
